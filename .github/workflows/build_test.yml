name: Call a reusable workflow and use its outputs

on:
  push:
    branches-ignore:
      - "no-ci-*"
  pull_request:
    branches:
      - "**"
env:
  VCPKG_SHA: 291b84e651bc21d90088394139097f9a5396cc00
  NUGET_REGISTRY: https://nuget.pkg.github.com/mathisloge/index.json
  NUGET_USERNAME: mathisloge
jobs:
  windows:
    uses: mathisloge/mapnik/.github/workflows/windows.yml@gh_ci
    with:
      VCPKG_SHA: ${{ env.VCPKG_SHA }}
      NUGET_REGISTRY: ${{ env.NUGET_REGISTRY }}
      NUGET_USERNAME: ${{ env.NUGET_USERNAME }}
    secrets:
      NUGET_REGISTRY_PAT: ${{ secrets.VCPKG_NUGET_CI }}

  ubuntu:
    uses: mathisloge/mapnik/.github/workflows/ubuntu.yml@gh_ci
    with:
      VCPKG_SHA: ${{ env.VCPKG_SHA }}
      NUGET_REGISTRY: ${{ env.NUGET_REGISTRY }}
      NUGET_USERNAME: ${{ env.NUGET_USERNAME }}
    secrets:
      NUGET_REGISTRY_PAT: ${{ secrets.VCPKG_NUGET_CI }}

  macos:
    uses: mathisloge/mapnik/.github/workflows/macos.yml@gh_ci
    with:
      VCPKG_SHA: ${{ env.VCPKG_SHA }}
      NUGET_REGISTRY: ${{ env.NUGET_REGISTRY }}
      NUGET_USERNAME: ${{ env.NUGET_USERNAME }}
    secrets:
      NUGET_REGISTRY_PAT: ${{ secrets.VCPKG_NUGET_CI }}
